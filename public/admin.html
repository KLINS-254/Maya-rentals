<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
:root{
    --gradient-start:#6a00f4;
    --gradient-end:#2a8cff;
    --primary-teal:#00d1c1;
    --text-gray:#aaaaaa;
    --bg-light:#f4f7f6;
}

body{
    margin:0;
    font-family:Arial, sans-serif;
    background:#f4f6f9;
}

/* Login Section */
#adminLoginSection{
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    height:100vh;
}
#adminLoginSection input{
    padding:12px 15px;
    margin:10px 0;
    border-radius:10px;
    border:1px solid #ccc;
    width:250px;
}
#adminLoginSection button{
    padding:12px 20px;
    border:none;
    border-radius:15px;
    background:linear-gradient(90deg,#6a00f4,#2a8cff);
    color:white;
    font-weight:bold;
    cursor:pointer;
}

/* Admin Dashboard */
#adminDashboard{
    display:none;
    padding:20px;
}
h2{margin-top:0;}

.user-card{
    background:white;
    border-radius:15px;
    padding:15px;
    margin-bottom:15px;
    box-shadow:0 2px 6px rgba(0,0,0,0.05);
}
.user-card p{
    margin:5px 0;
}
.user-card label{
    font-weight:bold;
}
.user-card input{
    padding:5px 10px;
    border-radius:8px;
    border:1px solid #ccc;
    width:100px;
}
.user-card .actions{
    margin-top:10px;
}
.user-card button{
    padding:8px 15px;
    margin-right:10px;
    border:none;
    border-radius:10px;
    cursor:pointer;
    font-weight:bold;
    color:white;
}
.update-btn{background:#20e060;}
.logout-btn{
    padding:10px 20px;
    border:none;
    background:linear-gradient(90deg,#6a00f4,#2a8cff);
    color:white;
    border-radius:10px;
    cursor:pointer;
    float:right;
}

/* Deposit notifications */
#depositNotifications{
    margin-top:30px;
}
.deposit-card{
    background:#fffae6;
    border-left:5px solid #f0b90b;
    padding:12px 15px;
    border-radius:8px;
    margin-bottom:10px;
}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="adminLoginSection">
    <h2>Admin Login</h2>
    <input type="password" id="adminPassword" placeholder="Enter Admin Password">
    <button id="adminLoginBtn">Login</button>
</div>

<!-- DASHBOARD -->
<div id="adminDashboard">
    <h2>
        Admin Dashboard
        <button class="logout-btn" id="logoutBtn">Logout</button>
    </h2>

    <h3>Users</h3>
    <div id="usersContainer"></div>

    <h3>Recent Deposits</h3>
    <div id="depositNotifications"></div>
</div>

<script>
// ===== Admin Password =====
const ADMIN_PASS = "SuperSecure123"; // set your admin password

// ===== Elements =====
const loginSection = document.getElementById("adminLoginSection");
const dashboard = document.getElementById("adminDashboard");
const loginBtn = document.getElementById("adminLoginBtn");
const passwordInput = document.getElementById("adminPassword");
const usersContainer = document.getElementById("usersContainer");
const logoutBtn = document.getElementById("logoutBtn");
const depositNotifications = document.getElementById("depositNotifications");

// ===== Check admin login =====
if(localStorage.getItem("adminLoggedIn") === "true"){
    showDashboard();
}

// ===== Login Function =====
loginBtn.addEventListener("click",()=>{
    const pass = passwordInput.value.trim();
    if(pass === ADMIN_PASS){
        localStorage.setItem("adminLoggedIn","true");
        showDashboard();
    } else {
        alert("Incorrect password!");
    }
});

// ===== Logout Function =====
logoutBtn.addEventListener("click",()=>{
    localStorage.removeItem("adminLoggedIn");
    location.reload();
});

// ===== Show Dashboard =====
function showDashboard(){
    loginSection.style.display = "none";
    dashboard.style.display = "block";
    renderUsers();
    renderDeposits();
}

// ===== Render Users =====
function renderUsers(){
    const users = JSON.parse(localStorage.getItem("users") || "[]").filter(u=>u.id);
    usersContainer.innerHTML = "";
    if(users.length === 0){
        usersContainer.innerHTML = "<p>No users registered yet.</p>";
        return;
    }

    users.forEach((user,index)=>{
        const userDiv = document.createElement("div");
        userDiv.className = "user-card";
        userDiv.innerHTML = `
            <p><b>User ID:</b> #${user.id}</p>
            <p><b>Name:</b> ${user.name}</p>
            <p><b>Email:</b> ${user.email}</p>
            <p><b>Phone:</b> ${user.phone}</p>
            <p>
                <label>Balance: KSH </label>
                <input type="number" value="${user.balance || 0}" id="balanceInput${index}">
                <button class="update-btn" onclick="updateBalance(${index})">Update</button>
            </p>
        `;
        usersContainer.appendChild(userDiv);
    });
}

// ===== Update Balance =====
function updateBalance(index){
    const users = JSON.parse(localStorage.getItem("users") || "[]").filter(u=>u.id);
    const input = document.getElementById("balanceInput"+index);
    let newBalance = parseFloat(input.value);
    if(isNaN(newBalance) || newBalance < 0){
        alert("Enter a valid balance");
        return;
    }
    users[index].balance = newBalance;
    localStorage.setItem("users",JSON.stringify(users));
    alert(`Balance updated for user #${users[index].id}`);
}

// ===== Render Deposits =====
function renderDeposits(){
    const deposits = JSON.parse(localStorage.getItem("deposits") || "[]");
    depositNotifications.innerHTML = "";
    if(deposits.length === 0){
        depositNotifications.innerHTML = "<p>No deposits yet.</p>";
        return;
    }
    deposits.slice(-10).reverse().forEach(deposit=>{
        const div = document.createElement("div");
        div.className = "deposit-card";
        div.innerHTML = `<b>${deposit.userName}</b> deposited KSH ${deposit.amount.toLocaleString()} via ${deposit.account.toUpperCase()}`;
        depositNotifications.appendChild(div);
    });
}

// ===== Listen to localStorage deposit updates =====
window.addEventListener("storage",(e)=>{
    if(e.key === "deposits"){
        renderDeposits();
    }
});
</script>

</body>
</html>
